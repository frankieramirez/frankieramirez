---
import { Image } from "astro:assets";

interface TimelineEvent {
  date: string;
  title: string;
  description: string;
  type: "work" | "personal";
  icon?: string;
}

const events: TimelineEvent[] = [
  {
    date: "Present",
    title: "Senior Frontend Engineer",
    description: "Leading frontend architecture and design systems...",
    type: "work",
  },
  {
    date: "2020 - 2023",
    title: "Frontend Developer",
    description: "Developed scalable web applications using React and TypeScript...",
    type: "work",
  },
  {
    date: "February 20, 2015",
    title: "Got Married",
    description: "A beautiful winter wedding surrounded by friends and family.",
    type: "personal",
  },
  {
    date: "2012 - 2015",
    title: "Junior Web Developer",
    description: "Started my journey in web development...",
    type: "work",
  },
  {
    date: "2010 - 2012",
    title: "Full Sail University",
    description: "Bachelor of Science in Web Design & Development. Valedictorian.",
    type: "work",
  },
  {
    date: "2009",
    title: "High School Graduation",
    description: "Graduated from high school.",
    type: "personal",
  },
  {
    date: "January 24, 1991",
    title: "Born",
    description: "The journey begins.",
    type: "personal",
  },
];
---

<section class="py-0 relative overflow-hidden" id="timeline-section">
  <div class="max-w-4xl mx-auto px-4 relative">
    <!-- Vertical Line -->
    <div class="absolute left-1/2 transform -translate-x-1/2 h-full w-px bg-gradient-to-b from-transparent via-primary/20 to-transparent"></div>
    
    <!-- Connecting Line from top -->
    <div class="absolute left-1/2 transform -translate-x-1/2 top-0 h-32 w-px bg-gradient-to-b from-transparent to-primary/20"></div>

    <div class="space-y-32 pt-32 pb-40">
      {events.map((event, index) => (
        <div class={`timeline-item flex items-center justify-between w-full ${index % 2 === 0 ? 'flex-row-reverse' : ''} group`}>
          
          <!-- Content Side -->
          <div class="w-5/12">
            <div class="p-6 bg-card/30 backdrop-blur-md border border-white/5 rounded-2xl shadow-lg transform transition-all duration-700 hover:border-primary/30 hover:bg-card/50 timeline-content opacity-0 translate-y-12">
              <span class="text-xs font-mono text-primary mb-2 block tracking-wider uppercase">{event.date}</span>
              <h3 class="text-2xl font-serif font-bold mb-2">{event.title}</h3>
              <p class="text-muted-foreground text-sm leading-relaxed">{event.description}</p>
            </div>
          </div>

          <!-- Center Dot -->
          <div class="absolute left-1/2 transform -translate-x-1/2 flex items-center justify-center">
            <div class="w-3 h-3 bg-primary rounded-full shadow-[0_0_20px_rgba(var(--color-primary),0.6)] z-10 timeline-dot scale-0 transition-transform duration-700 delay-100">
               <div class="absolute inset-0 bg-primary rounded-full animate-ping opacity-20 duration-1000"></div>
            </div>
          </div>

          <!-- Empty Side for spacing -->
          <div class="w-5/12"></div>
        </div>
      ))}
    </div>
  </div>
</section>

<script>
  const observerOptions = {
    root: null,
    rootMargin: "-20% 0px -20% 0px", // Trigger when item is in the middle 60% of screen
    threshold: 0.1
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      const content = entry.target.querySelector('.timeline-content');
      const dot = entry.target.querySelector('.timeline-dot');

      if (entry.isIntersecting) {
        // Animate in
        content?.classList.remove('opacity-0', 'translate-y-8');
        content?.classList.add('opacity-100', 'translate-y-0', 'scale-105'); // Zoom effect
        dot?.classList.remove('scale-0');
        dot?.classList.add('scale-150'); // Dot zoom
      } else {
        // Animate out (optional, for re-triggering)
        content?.classList.add('opacity-0', 'translate-y-8');
        content?.classList.remove('opacity-100', 'translate-y-0', 'scale-105');
        dot?.classList.add('scale-0');
        dot?.classList.remove('scale-150');
      }
    });
  }, observerOptions);

  document.querySelectorAll('.timeline-item').forEach(item => {
    observer.observe(item);
  });
</script>

<style>
  /* Smooth transition for the zoom effect */
  .timeline-content {
    transition: all 0.7s cubic-bezier(0.17, 0.55, 0.55, 1);
  }
  .timeline-dot {
    transition: transform 0.5s cubic-bezier(0.17, 0.55, 0.55, 1);
  }
</style>
